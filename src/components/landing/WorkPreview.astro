---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import yourProjectImage from "@assets/images/projects/yourProject.png";
import WokCard from "@components/work/WokCard.astro";
import { getLangFromUrl, useTranslatedPath, useTranslations } from "@i18n/utils";
import virgoSpaceImage from "@assets/images/portfolio/virgospace.png";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

const { class: className } = Astro.props;

const allProjects = (await getCollection("projects"))
	.filter((prj) => {
		const [postLang, ...slug] = prj.slug.split("/");
		return postLang === lang;
	})
	.map((prj) => {
		const [postLang, slug] = prj.slug.split("/");

		return {
			...prj,
			slug: slug,
		};
	})
	.sort((a, b) => Number(b.data.pubDate) - Number(a.data.pubDate));
---

<section id="virgo-space" class:list={["section virgo-space-section home-dark-section py-20", className]}>
	<div class="col-span-12 col-start-1 mx-auto max-w-5xl text-center">
		<h2 class="font-display text-4xl uppercase mb-6 md:text-5xl lg:text-6xl">Virgo Space</h2>
		<p class="text-lg mb-12 max-w-3xl mx-auto text-black">A transformative space where entrepreneurs accelerate growth, innovate solutions, and scale exceptional businesses</p>

		<div class="virgo-space-image mb-12">
			<Image
				src={virgoSpaceImage}
				alt="Virgo Space - Where entrepreneurs grow"
				class="mx-auto rounded-2xl shadow-2xl max-w-2xl w-full h-96 object-cover"
				width={384}
				height={384}
				widths={[384, 768]}
				sizes="(max-width: 768px) 384px, 768px"
				format="webp"
				quality={50}
				loading="lazy"
			/>
		</div>

		<div class="virgo-space-pillars grid grid-cols-1 md:grid-cols-3 gap-8 max-w-2xl mx-auto">
			<div class="pillar text-center">
				<h3 class="font-display text-2xl mb-2 text-amber-500">Subscribe</h3>
				<p class="text-sm text-black">Join our community of growth-focused leaders</p>
			</div>
			<div class="pillar text-center">
				<h3 class="font-display text-2xl mb-2 text-amber-500">Empower</h3>
				<p class="text-sm text-black">Access proven operational frameworks</p>
			</div>
			<div class="pillar text-center">
				<h3 class="font-display text-2xl mb-2 text-amber-500">Accelerate</h3>
				<p class="text-sm text-black">Fast-track growth with strategic capital</p>
			</div>
		</div>
	</div>
</section>

<style is:global>
	.work-preview-section ol li img {
		--clip: 0%;
		clip-path: inset(var(--clip) round 0.5rem);
	}
</style>

<script>
	import { gsap } from "gsap";
	import { ScrollTrigger } from "gsap/ScrollTrigger";

	gsap.registerPlugin(ScrollTrigger);

	function init() {
		// Animate Virgo Space elements on scroll
		gsap.from(".virgo-space-image img", {
			scrollTrigger: {
				trigger: ".virgo-space-image",
				start: "top bottom",
				end: "center center",
				scrub: 1,
				markers: false,
			},
			ease: "power3.out",
			scale: 0.8,
			opacity: 0,
		});

		// Animate pillars
		gsap.from(".pillar", {
			scrollTrigger: {
				trigger: ".virgo-space-pillars",
				start: "top bottom",
				end: "center center",
				scrub: 1,
				markers: false,
			},
			ease: "power3.out",
			y: 50,
			opacity: 0,
			stagger: 0.1,
		});

		// Background transition
		gsap.to(".home-dark-section", {
			scrollTrigger: {
				trigger: ".virgo-space-section",
				start: "bottom bottom",
				end: "bottom 70%",
				scrub: 0.5,
				markers: false,
				immediateRender: false,
			},
			ease: "none",
			backgroundColor: "#18181b",
			color: "#fff",
		});
	}

	document.removeEventListener("DOMContentLoaded", init);
	document.addEventListener("DOMContentLoaded", init);
</script>
